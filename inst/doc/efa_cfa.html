<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="structural-models-efa-cfa-sem">Structural Models (EFA, CFA, SEM…)</h1>
<ul>
<li><a href="#how-to-perform-a-factor-analysis-fa">How to perform a Factor Analysis (FA)</a>
<ul>
<li><a href="#factor-structure-sphericity-and-kmo">Factor Structure (Sphericity and KMO)</a></li>
<li><a href="#exploratory-factor-analysis-efa">Exploratory Factor Analysis (EFA)</a></li>
<li><a href="#how-many-factors-to-retain-in-factor-analysis-fa">How many factors to retain in Factor Analysis (FA)</a>
<ul>
<li><a href="#the-method-agreement-procedure">The Method Agreement procedure</a></li>
</ul></li>
<li><a href="#confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)</a>
<ul>
<li><a href="#partition-the-data">Partition the data</a></li>
<li><a href="#create-cfa-structures-out-of-efa-models">Create CFA structures out of EFA models</a></li>
<li><a href="#fit-and-compare-models">Fit and Compare models</a></li>
</ul></li>
</ul></li>
<li><a href="#structural-equation-modeling">Structural Equation Modeling</a></li>
<li><a href="#references">References</a></li>
</ul>
<h1 id="how-to-perform-a-factor-analysis-fa">How to perform a Factor Analysis (FA)</h1>
<p>The difference between PCA and EFA can be quite hard to intuitively grasp as their output is very familiar. The idea is that PCA aims at extracting the most variance possible from all variables of the dataset, whereas EFA aims at creating consistent factors from the dataset without desperately trying to represent all the variables.</p>
<p>This is why PCA is popular for feature reduction, as it will try to best represent the variance contained in the original data, minimizing the loss of information. On the other hand, EFA is usually in the context of exploring the latent dimensions that might be hidden in the observed variables, without necessary striving at representing the whole dataset.</p>
<p>To illustrate EFA, let us use the <a href="https://ipip.ori.org/">International Personality Item Pool</a> data available in the <a href="https://www.personality-project.org/r/html/bfi.html"><code>psych</code></a> package. It includes 25 personality self report items. The authors built these items following the <strong>big 5</strong> personality structure.</p>
<h2 id="factor-structure-sphericity-and-kmo">Factor Structure (Sphericity and KMO)</h2>
<p>The first step is to test the dataset for factor analysis suitability. Two existing methods are the <strong>Bartlett’s Test of Sphericity</strong> and the <strong>Kaiser, Meyer, Olkin (KMO) Measure of Sampling Adequacy (MSA)</strong>. The former tests whether a matrix is significantly different from an identity matrix. This statistical test for the presence of correlations among variables, providing the statistical probability that the correlation matrix has significant correlations among at least some of variables. As for factor analysis to work, some relationships between variables are needed, thus, a significant Bartlett’s test of sphericity is required, say <em>p</em> &lt; .001. The latter was introduced by Kaiser (1970) as the Measure of Sampling Adequacy (MSA), later modified by Kaiser and Rice (1974). The Kaiser-Meyer-Olkin (KMO) statistic, which can vary from 0 to 1, indicates the degree to which each variable in a set is predicted without error by the other variables. A value of 0 indicates that the sum of partial correlations is large relative to the sum correlations, indicating factor analysis is likely to be inappropriate. A KMO value close to 1 indicates that the sum of partial correlations is not large relative to the sum of correlations and so factor analysis should yield distinct and reliable factors.</p>
<p>Both tests can be performed by using the <code>check_factorstructure()</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(parameters)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(psych)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Load the data</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>data &lt;-<span class="st"> </span>psych<span class="op">::</span>bfi[, <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>]  <span class="co"># Select only the 25 first columns corresponding to the items</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>data &lt;-<span class="st"> </span><span class="kw">na.omit</span>(data)  <span class="co"># remove missing values</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Check factor structure</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">check_factorstructure</span>(data)</span></code></pre></div>
<pre><code>#&gt; # Is the data suitable for Factor Analysis?
#&gt; 
#&gt;   - KMO: The Kaiser, Meyer, Olkin (KMO) measure of sampling adequacy suggests that data seems appropriate for factor analysis (KMO = 0.85).
#&gt;   - Sphericity: Bartlett&#39;s test of sphericity suggests that there is sufficient significant correlation in the data for factor analysis (Chisq(300) = 18146.07, p &lt; .001).
</code></pre>
<h2 id="exploratory-factor-analysis-efa">Exploratory Factor Analysis (EFA)</h2>
<p>Now that we are confident that our dataset is appropriate, we will explore a factor structure made of 5 latent variables, corresponding to the items’ authors theory of personality.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Fit an EFA</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>efa &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">fa</span>(data, <span class="dt">nfactors =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">  </span><span class="kw">model_parameters</span>(<span class="dt">sort =</span> <span class="ot">TRUE</span>, <span class="dt">threshold =</span> <span class="st">&quot;max&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>efa</span></code></pre></div>
<pre><code>#&gt; # Rotated loadings from Factor Analysis (oblimin-rotation)
#&gt; 
#&gt; Variable |  MR2 |   MR3 |   MR1 |   MR5 |   MR4 | Complexity | Uniqueness
#&gt; -------------------------------------------------------------------------
#&gt; N1       | 0.83 |       |       |       |       |       1.07 |       0.32
#&gt; N2       | 0.78 |       |       |       |       |       1.03 |       0.39
#&gt; N3       | 0.70 |       |       |       |       |       1.08 |       0.46
#&gt; N5       | 0.48 |       |       |       |       |       2.00 |       0.65
#&gt; N4       | 0.47 |       |       |       |       |       2.33 |       0.49
#&gt; C2       |      |  0.67 |       |       |       |       1.18 |       0.55
#&gt; C4       |      | -0.64 |       |       |       |       1.13 |       0.52
#&gt; C3       |      |  0.57 |       |       |       |       1.10 |       0.68
#&gt; C5       |      | -0.56 |       |       |       |       1.41 |       0.56
#&gt; C1       |      |  0.55 |       |       |       |       1.20 |       0.65
#&gt; E2       |      |       |  0.67 |       |       |       1.08 |       0.45
#&gt; E4       |      |       | -0.59 |       |       |       1.52 |       0.46
#&gt; E1       |      |       |  0.55 |       |       |       1.22 |       0.65
#&gt; E5       |      |       | -0.42 |       |       |       2.68 |       0.59
#&gt; E3       |      |       | -0.41 |       |       |       2.65 |       0.56
#&gt; A3       |      |       |       |  0.68 |       |       1.06 |       0.46
#&gt; A2       |      |       |       |  0.66 |       |       1.03 |       0.54
#&gt; A5       |      |       |       |  0.54 |       |       1.48 |       0.53
#&gt; A4       |      |       |       |  0.45 |       |       1.74 |       0.70
#&gt; A1       |      |       |       | -0.44 |       |       1.88 |       0.80
#&gt; O3       |      |       |       |       |  0.62 |       1.16 |       0.53
#&gt; O5       |      |       |       |       | -0.54 |       1.21 |       0.70
#&gt; O1       |      |       |       |       |  0.52 |       1.10 |       0.68
#&gt; O2       |      |       |       |       | -0.47 |       1.68 |       0.73
#&gt; O4       |      |       |       |       |  0.36 |       2.65 |       0.75
#&gt; 
#&gt; The 5 latent factors (oblimin rotation) accounted for 42.36% of the total variance of the original data (MR2 = 10.31%, MR3 = 8.39%, MR1 = 8.83%, MR5 = 8.29%, MR4 = 6.55%).
</code></pre>
<p>As we can see, the 25 items nicely spread on the 5 latent factors, the famous <strong>big 5</strong>. Based on this model, we can now predict back the scores for each individual for these new variables:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">predict</span>(efa, <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;Neuroticism&quot;</span>, <span class="st">&quot;Conscientiousness&quot;</span>, <span class="st">&quot;Extraversion&quot;</span>, <span class="st">&quot;Agreeableness&quot;</span>, <span class="st">&quot;Opennness&quot;</span>))</span></code></pre></div>
<pre><code>#&gt;   Neuroticism Conscientiousness Extraversion Agreeableness Opennness
#&gt; 1       -0.22            -1.327       -0.128        -0.855     -1.61
#&gt; 2        0.16            -0.572       -0.466        -0.072     -0.17
#&gt; 3        0.62            -0.043       -0.141        -0.552      0.23
#&gt; 4       -0.12            -1.063       -0.058        -0.091     -1.06
#&gt; 5       -0.17            -0.099       -0.460        -0.712     -0.66
</code></pre>
<h2 id="how-many-factors-to-retain-in-factor-analysis-fa">How many factors to retain in Factor Analysis (FA)</h2>
<p>When running a <strong>factor analysis (FA)</strong>, one often needs to specify <strong>how many components</strong> (or latent variables) to retain or to extract. This decision is often motivated or supported by some statistical indices and procedures aiming at finding the optimal number of factors.</p>
<p>Interestingly, a huge amount of methods exist to statistically address this issue, giving sometimes very different results… Unfortunately, there is no consensus on <strong>which method to use</strong>, or which is the best.</p>
<h3 id="the-method-agreement-procedure">The Method Agreement procedure</h3>
<p>The Method Agreement procedure, first implemented in the <a href="https://neuropsychology.github.io/psycho.R/2018/05/24/n_factors.html"><code>psycho</code></a> package (Makowski 2018), proposes to rely on the consensus of methods, rather than on one method in particular.</p>
<p>This procedure can be easily used via the <code>n_factors()</code> function, re-implemented and improved in the <a href="https://github.com/easystats/parameters"><strong>parameters</strong></a> package. One can provide a dataframe, and the function will run a large number of routines and return the optimal number of factors based on the higher consensus.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n &lt;-<span class="st"> </span><span class="kw">n_factors</span>(data)</span>
<span id="cb7-2"><a href="#cb7-2"></a>n</span></code></pre></div>
<pre><code>#&gt; # Method Agreement Procedure:
#&gt; 
#&gt; The choice of 1 dimensions is supported by 3 (13.04%) methods out of 23 (Acceleration factor, TLI, RMSEA).
</code></pre>
<p>Interestingly, the smallest nubmer of factors that most methods suggest is 6… Which is consistent whith the newer models of personality (e.g., HEXACO).</p>
<p>More details, as well as a summary table can be obtained as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">as.data.frame</span>(n)</span></code></pre></div>
<pre><code>#&gt;    n_Factors              Method              Family
#&gt; 1          1 Acceleration factor               Scree
#&gt; 2          1                 TLI                 Fit
#&gt; 3          1               RMSEA                 Fit
#&gt; 4          3                 CNG                 CNG
#&gt; 5          4                beta Multiple_regression
#&gt; 6          4    VSS complexity 1                 VSS
#&gt; 7          5    VSS complexity 2                 VSS
#&gt; 8          5       Velicer&#39;s MAP        Velicers_MAP
#&gt; 9          6 Optimal coordinates               Scree
#&gt; 10         6   Parallel analysis               Scree
#&gt; 11         6    Kaiser criterion               Scree
#&gt; 12         7                   t Multiple_regression
#&gt; 13         7                   p Multiple_regression
#&gt; 14         7                  R2            Scree_SE
#&gt; 15         8            SE Scree            Scree_SE
#&gt; 16         8                 BIC                 BIC
#&gt; 17         8                 BIC                 Fit
#&gt; 18        11      BIC (adjusted)                 BIC
#&gt; 19        18                CRMS                 Fit
#&gt; 20        22             Bentler             Bentler
#&gt; 21        24            Bartlett             Barlett
#&gt; 22        24            Anderson             Barlett
#&gt; 23        24              Lawley             Barlett
</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">summary</span>(n)</span></code></pre></div>
<pre><code>#&gt;    n_Factors n_Methods
#&gt; 1          1         3
#&gt; 2          3         1
#&gt; 3          4         2
#&gt; 4          5         2
#&gt; 5          6         3
#&gt; 6          7         3
#&gt; 7          8         3
#&gt; 8         11         1
#&gt; 9         18         1
#&gt; 10        22         1
#&gt; 11        24         3
</code></pre>
<p>A plot can also be obtained (the <code>see</code> package must be loaded):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(see)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">plot</span>(n) <span class="op">+</span><span class="st"> </span><span class="kw">theme_modern</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h2 id="confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)</h2>
<p>We’ve seen above that while an EFA with 5 latent variables works great on our dataset, a structure with 6 latent factors might in fact be more appropriate. How can we <strong>statistically test</strong> if that’s actually the case? This can be done using Confirmatory Factor Analysis (CFA), that bridges factor analysis with Structural Equation Modelling (SEM).</p>
<p>However, in order to do that cleanly, EFA should be independent from CFA, in the sense that the factor structure should be explored on a <strong>“training” set</strong>, and then tested (or “confirmed”) on a <strong>test set</strong>. In other words, the dataset used for exploration and confirmation is not the same. Note that this procedure is also standard in the field of machine learning.</p>
<h3 id="partition-the-data">Partition the data</h3>
<p>The data can be easily split into two sets with the <code>data_partition()</code> function, through which we will use 70% of the sample as training and the rest as test.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>partitions &lt;-<span class="st"> </span><span class="kw">data_partition</span>(data, <span class="dt">training_proportion =</span> <span class="fl">0.7</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>training &lt;-<span class="st"> </span>partitions<span class="op">$</span>training</span>
<span id="cb14-3"><a href="#cb14-3"></a>test &lt;-<span class="st"> </span>partitions<span class="op">$</span>test</span></code></pre></div>
<h3 id="create-cfa-structures-out-of-efa-models">Create CFA structures out of EFA models</h3>
<p>In the next step, we will run two EFA models on the training set, specifying 5 and 6 latent factors respectively, that we will then transform into CFA structures.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>structure_big5 &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">fa</span>(training, <span class="dt">nfactors =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">efa_to_cfa</span>()</span>
<span id="cb15-3"><a href="#cb15-3"></a>structure_big6 &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">fa</span>(training, <span class="dt">nfactors =</span> <span class="dv">6</span>)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="st">  </span><span class="kw">efa_to_cfa</span>()</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># Investigate how a model looks</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>structure_big5</span></code></pre></div>
<pre><code>#&gt; # Latent variables
#&gt; MR2 =~ N1 + N2 + N3 + N4 + N5
#&gt; MR1 =~ E1 + E2 + E3 + E4 + E5
#&gt; MR3 =~ C1 + C2 + C3 + C4 + C5
#&gt; MR5 =~ A1 + A2 + A3 + A4 + A5
#&gt; MR4 =~ O1 + O2 + O3 + O4 + O5
</code></pre>
<p>As we can see, a structure is just a string encoding how the <strong>manifest variables</strong> (the observed variables) are integrated into latent variables.</p>
<h3 id="fit-and-compare-models">Fit and Compare models</h3>
<p>We can finally with that structure to the test set using the <code>lavaan</code> package, and compare these models together:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">library</span>(lavaan)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">library</span>(performance)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>big5 &lt;-<span class="st"> </span>lavaan<span class="op">::</span><span class="kw">cfa</span>(structure_big5, <span class="dt">data =</span> test)</span>
<span id="cb17-5"><a href="#cb17-5"></a>big6 &lt;-<span class="st"> </span>lavaan<span class="op">::</span><span class="kw">cfa</span>(structure_big6, <span class="dt">data =</span> test)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>performance<span class="op">::</span><span class="kw">compare_performance</span>(big5, big6)</span></code></pre></div>
<pre><code>#&gt; # Comparison of Model Performance Indices
#&gt; 
#&gt; Model |   Type |   Chisq | Chisq_df | Chisq_p | Baseline | Baseline_df | Baseline_p |  GFI | AGFI |  NFI | NNFI |  CFI | RMSEA | RMSEA_CI_low | RMSEA_CI_high | RMSEA_p |  RMR | SRMR |  RFI | PNFI |  IFI |  RNI | Loglikelihood |      AIC |      BIC | BIC_adjusted | BF
#&gt; ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#&gt; big5  | lavaan | 1357.27 |      265 |       0 |  5821.53 |         300 |          0 | 0.86 | 0.82 | 0.77 | 0.78 | 0.80 |  0.07 |         0.07 |          0.08 |       0 | 0.16 | 0.08 | 0.74 | 0.68 | 0.80 | 0.80 |     -29897.05 | 59914.10 | 60189.76 |     59999.24 |   
#&gt; big6  | lavaan | 1529.93 |      265 |       0 |  5821.53 |         300 |          0 | 0.84 | 0.81 | 0.74 | 0.74 | 0.77 |  0.08 |         0.08 |          0.08 |       0 | 0.18 | 0.08 | 0.70 | 0.65 | 0.77 | 0.77 |     -29983.38 | 60086.76 | 60362.43 |     60171.91 |  0
</code></pre>
<p>All in all, it seems that the big 5 structure remains quite reliable.</p>
<h1 id="structural-equation-modeling">Structural Equation Modeling</h1>
<p>The last example shows one of the enormous amount of modeling possibilities for structural equation models, in particular an example for mediation analysis, i.e. a model that estimates indirect effects in partial mediation structures.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>M &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>Y &lt;-<span class="st"> </span><span class="fl">0.7</span> <span class="op">*</span><span class="st"> </span>M <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>Data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">X =</span> X, <span class="dt">Y =</span> Y, <span class="dt">M =</span> M)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>model &lt;-<span class="st"> &#39; # direct effect</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="st">             Y ~ c*X</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="st">           # mediator</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="st">             M ~ a*X</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="st">             Y ~ b*M</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="st">           # indirect effect (a*b)</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="st">             ab := a*b</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="st">           # total effect</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="st">             total := c + (a*b)</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="st">         &#39;</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>fit &lt;-<span class="st"> </span><span class="kw">sem</span>(model, <span class="dt">data =</span> Data, <span class="dt">test =</span> <span class="st">&quot;Satorra-Bentler&quot;</span>)</span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="kw">model_parameters</span>(fit)</span></code></pre></div>
<pre><code>#&gt; # Regression 
#&gt; 
#&gt; Link      | Coefficient |   SE |        95% CI |      p
#&gt; -------------------------------------------------------
#&gt; Y ~ X (c) |        0.04 | 0.10 | [-0.17, 0.24] | 0.728 
#&gt; M ~ X (a) |        0.47 | 0.10 | [ 0.27, 0.68] | &lt; .001
#&gt; Y ~ M (b) |        0.79 | 0.09 | [ 0.61, 0.97] | &lt; .001
#&gt; 
#&gt; # Defined 
#&gt; 
#&gt; Link             | Coefficient |   SE |       95% CI |      p
#&gt; -------------------------------------------------------------
#&gt; ab := a*b        |        0.37 | 0.09 | [0.19, 0.55] | &lt; .001
#&gt; total := c+(a*b) |        0.41 | 0.12 | [0.17, 0.65] | 0.001
</code></pre>
<h1 id="references">References</h1>
<div id="refs" class="references hanging-indent">

<div id="ref-makowski2018psycho">

<p>Makowski, Dominique. 2018. “The Psycho Package: An Efficient and Publishing-Oriented Workflow for Psychological Science.” <em>Journal of Open Source Software</em> 3 (22): 470.</p>
</div>

</div>

</body>
</html>
